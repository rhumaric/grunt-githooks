#!/usr/bin/env node

// ... Some code that will be run before the hook
console.log(process.cwd());

// GRUNT-GITHOOKS START
var exec = require('child_process').exec,
    fs = require('fs');

fs.open('{{expectedWorkingDir}}/Gruntfile.js', 'r', function(err, data) {
  var exitCode = 0;
  if ( err ) {
    // Gruntfile.js does not exist exit cleanly.
    process.exit(exitCode);
  }

  exec('grunt githooks::pre-commit --gruntfile {{expectedWorkingDir}}/Gruntfile.js', {
    cwd: '{{expectedWorkingDir}}'
  }, function (err, stdout, stderr) {

    console.log(stdout);

    if (err) {
      console.log(stderr || err);
      exitCode = -1;
    }
  });
});


// GRUNT-GITHOOKS END

// ... Some code that will be run after the hook... if it does not exit, that is
console.log(process.cwd());